!function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:a})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){n(1);const a=n(2);self.addEventListener("push",e=>{let t;e.data?(t=JSON.parse(e.data.text()),console.log(t)):t={status:"NO_STATUS",message:"IRIS has new data!"},console.log(a(t)[1]),e.waitUntil(async function(e){console.log("sending status"),self.clients.matchAll().catch(()=>[]).then(t=>t.map(t=>t.postMessage(e)))}(t)),e.waitUntil(self.registration.showNotification(...a(t)))}),self.addEventListener("notificationclick",e=>{"close"===e.action?e.notification.close():"view"===e.action?e.waitUntil(self.clients.matchAll().then(t=>{let n=!1;for(let a=0;a<t.length;a+=1)if(t[a].url===e.notification.data.url){n=!0,t[a].focus();break}n||t.length&&(t[0].navigate(e.notification.data.url),t[0].focus())}).then(()=>e.notification.close())):e.waitUntil(self.clients.matchAll().then(e=>{e.length&&e[0].focus()}).then(()=>e.notification.close()))})},function(e,t){const n={offline:"offline-v1"};self.addEventListener("install",e=>{e.waitUntil(fetch(function(e){const t=new Request(e,{cache:"reload"});if("cache"in t)return t;const n=new URL(e,self.location.href);return n.search+=`${n.search?"&":""}cachebust=${Date.now()}`,new Request(n)}("offline.html")).then(e=>caches.open(n.offline).then(t=>t.put("offline.html",e))))}),self.addEventListener("activate",e=>{const t=Object.keys(n).map(e=>n[e]);e.waitUntil(caches.keys().then(e=>Promise.all(e.map(e=>-1===t.indexOf(e)?(console.log("Deleting out of date cache:",e),caches.delete(e)):null))))}),self.addEventListener("fetch",e=>{("navigate"===e.request.mode||"GET"===e.request.method&&e.request.headers.get("accept").includes("text/html"))&&e.respondWith(fetch(e.request).catch(e=>(console.log("Fetch failed; returning offline page instead.",e),caches.match("offline.html"))))})},function(e,t){e.exports=function(e){const t=["From IRIS"],n={body:e.message?e.message:"IRIS has new data!",icon:"images/irisProposed_withoutBackground_small.png",vibrate:[100,50,100],data:{dateOfArrival:Date.now(),primaryKey:1},actions:[{action:"explore",title:"Go to the site"},{action:"close",title:"Close the notification"}]};if(e.status)switch(e.status){case"NEW_MESSAGE":n.actions[0].action="view",n.actions[0].title="See message",e.id?n.data={url:`/#/messages/${e.id}`}:n.data={url:"/#/messages"},t.push(n);break;default:t.push(n)}return t}}]);